<!DOCTYPE html>

<html><head>
 <meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.5, user-scalable=yes" />
 <title>Loading - Wilderness Ranger</title>
 <link rel="stylesheet" href="/web/main.min.css" />
 <link rel="stylesheet" href="/web/font/icons.css" />
 <script src="//cdn.jsdelivr.net/npm/prismjs@1.22/components/prism-core.min.js"></script>
 <script src="//cdn.jsdelivr.net/npm/prismjs@1.22/plugins/autoloader/prism-autoloader.min.js"></script>
 <link rel="stylesheet" href="/web/prism.css" />
</head><body>

<nav id="floater">
 <img class="floater-avatar" src="/web/avatar.png" /><a class="floater-header" href="/main">Wilderness Ranger</a>
 <button class="floater-menu icon" title="Settings">âš™</button><ul class="floater-cascade">
  <a class="icon-list" onclick="interact('M');">Markdown</a>
  <hr />
  <a class="icon-moon" onclick="interact('D');">Auto</a>
 </ul>
 <button class="floater-menu icon" title="Information">i</button><ul class="floater-cascade">
  <a href="https://github.com/WRtux/blog">Version 0.4</a>
 </ul>
</nav>

<header id="banner">
 <h1>Blog List</h1>
 <hr />
 <input type="text" class="banner-focus" placeholder="Search" />
 <div class="banner-background" style="background-image: url(/media/main/train-mountain.jpg);"></div>
</header>

<main id="wrapper">
 <!-- Dynamic -->
 <article>
  <h2>Loading</h2>
  <p>Markdown reader by Wilderness Ranger. <noscript>To run Marked renderer, please enable JavaScript.</noscript></p>
 </article>
</main>

<script src="/web/marked.min.js"></script>

<script src="/web/main.min.js"></script>
<script type="text/javascript">"use strict";
var url = "/blog/";

function interact(act) {
	switch(act) {
	case "dark":
	case 'D':
		switchDark();
		break;
	}
}

/*
(function () {
	var w = document.queryId("wrapper");
	var lis = sortList(fetchList(url).list);
	w.removeChildren();
	for (var i = lis.length - 1; i >= 0; i--) {
		var cont = document.createElement("article");
		renderAbstract(cont, fetchContent(url + lis[i]).content);
		cont.setClass("marked-abstract");
		cont.setAttribute("href", location.pathname + "/" + lis[i].slice(0, -3));
		cont.onclick = function () { location.assign(this.getAttribute("href")); };
		w.appendChild(cont);
	}
})();
*/
void async function () {
	let wrap = document.getElementById('wrapper');
	let f = false;
	function append(el) {
		if (!f) {
			wrap.removeChildren();
			f = true;
		}
		wrap.appendChild(el);
	}
	try {
		let li = await fetchArticleList('/blog/meta.xml');
		for (let en of li.reverse()) {
			let cont = document.createElement('article');
			cont.classList.add('marked-abstract');
			cont.setAttribute('href', '/list/' + en.fileName);
			cont.addEventListener('click', (e) => location.assign(e.currentTarget.getAttribute('href')));
			await renderURL(cont, '/blog/' + en.fileName, {abstract: true});
			append(cont);
		}
	} catch (err) {
		let cont = document.createElement('article');
		cont.appendChild(buildFailure(err));
		append(cont);
	}
}();

</script>
</body></html>
